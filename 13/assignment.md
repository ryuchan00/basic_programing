基礎プログラミングおよび演習レポート ＃13
学籍番号:1920031
氏名:山川竜太郎
ペア学籍番号・氏名(または「個人作業」):個人
提出日付:2020/2/1

[課題の再掲]
演習3
a. 数字列の先頭が0ではじまったら8進として受け取るようにする。

[実施したこととその結果]

作成したプログラム、octal.c

例題を変更して、0から入力値が始まったら8進数として扱い、10進数に変換して出力した。

```
#include <stdio.h>
#include <stdbool.h>
#include <stdlib.h>
#include <math.h>

bool getl(char s[], int lim, int *octal, int *length) {
    int c, i = 0;
    for (c = getchar(); c != EOF && c != '\n';
         c = getchar()) {
        s[i++] = c;
        if (s[0] == '0') {
            *octal = 1;
            i--;
        }
        if (i + 1 >= lim) { break; }
    }
    *length = i;
    s[i] = '\0';
    return c != EOF;
}

int main(void) {
    int i, n, octal = 0, length, number;
    char buf[100];
    printf("n> ");
    getl(buf, 100, &octal, &length);
    n = atoi(buf);
    if (octal == 1) {
        n = 0;
        for (i = 0; i < length; i++) {
            // '0'は整数値48、それから引くと文字列から数値に変換できる
            n += (buf[i] - '0') * pow(8, length - 1 - i);
        }
    }
    printf("%d\n", n);
    return 0;
}
```

実行結果

```
# 10進数はそのまま出力される
$ ./octal
n> 1
1
$ ./octal
n> 10
10
# 8進数は10進数に変換される
$ ./octal
n> 08
8
$ ./octal
n> 010
8
$ ./octal
n> 067
55
```

[考察]

このプログラムで一番考えるべきことは、8進数から10進数への変換はどこで行うかである。getlメソッド内で変換を行うのは1つのメソッドとして役割が絞れていない気がした。getlメソッドは、入力された文字列をbuf変数に格納するのが役目である。ただし入力値を検査して、8進数か否かのフラグのポインターを渡すようにした。これで、読み込んだ文字列が8進数かどうかはメソッドの外でも分かる。また8進数の変換では、ある桁の数値 × 8の(桁目 - 1)乗を初めの桁から終わりの桁までやれば求めることができるので、文字列の最終的な長さが必要である。したがってgetlに文字列の長さをポインターとして渡した。8進数から10進数への変換はgetlへ参照渡しで渡した変数を使用してmainメソッドで行うことが今の規模のプログラムだと見通しが良くなるようにした。

[アンケート]
Q1. 文字列の基本的な操作ができるようになりましたか。
少しだけできるようになりました

Q2. 文字列から整数や実数を作り出す原理が分かりましたか。
少しだけわかりました。

Q3. リフレクション(今回の課題で分かったこと)・感想・要望をどうぞ。
ポインターを使用した言語は今まで経験がないので苦戦しました。
